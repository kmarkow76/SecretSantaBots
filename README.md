# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ SecretSantaBot

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
**SecretSantaBot** ‚Äî —ç—Ç–æ Telegram-–±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏–≥—Ä—ã "–¢–∞–π–Ω—ã–π –°–∞–Ω—Ç–∞". –ë–æ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å –∏–≥—Ä—É, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–∞—Ä—ã –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```plaintext
SecretSantaBot
‚îú‚îÄ‚îÄ Config                     // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ appsettings.json       // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ Controllers                // –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ AdminController.cs     // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ UserController.cs      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ CommandHandler.cs      // –û–±—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
‚îú‚îÄ‚îÄ Services                   // –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ GameService.cs         // –õ–æ–≥–∏–∫–∞ –∏–≥—Ä—ã (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
‚îÇ   ‚îú‚îÄ‚îÄ AdminValidationService.cs // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ NotificationService.cs // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
‚îÇ   ‚îú‚îÄ‚îÄ PairingService.cs      // –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ ValidationService.cs   // –û–±—â–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ Validators                 // –õ–æ–≥–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ GameValidation.cs      // –í–∞–ª–∏–¥–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ ParticipantValidation.cs // –í–∞–ª–∏–¥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Database                   // –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç
‚îÇ   ‚îú‚îÄ‚îÄ CRUD
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ParticipantCrudOperations.cs // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ GameCrudOperations.cs      // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏–≥—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ ApplicationDbContext.cs // –ö–æ–Ω—Ç–µ–∫—Å—Ç Entity Framework Core
‚îÇ   ‚îú‚îÄ‚îÄ Models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Game.cs             // –ú–æ–¥–µ–ª—å –∏–≥—Ä—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Participant.cs      // –ú–æ–¥–µ–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ Migrations             // –ú–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ Config                     // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ AppSettings.json       // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ BotConfig.cs           // –ß—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–∫–ª—é—á–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
‚îî‚îÄ‚îÄ Program.cs                 // –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

---

## –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- **`/start <–≤–∞–ª—é—Ç–∞> <—Å—É–º–º–∞>`**  
  üîπ –ù–∞—á–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é.  
  _–û–ø–∏—Å–∞–Ω–∏–µ:_ –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–µ–º –∑–∞—è–≤–æ–∫ –Ω–∞ —É—á–∞—Å—Ç–∏–µ. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —É–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞–ª—é—Ç—É –∏ —Å—É–º–º—É –ø–æ–¥–∞—Ä–∫–∞.  
  ‚úâÔ∏è _–û—Ç–≤–µ—Ç:_ –ë–æ—Ç —É–≤–µ–¥–æ–º–ª—è–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ –Ω–∞—á–∞–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏.

- **`/stop`**  
  üîπ –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é.  
  _–û–ø–∏—Å–∞–Ω–∏–µ:_ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∏–µ–º –∑–∞—è–≤–æ–∫, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ –ø–∞—Ä–∞–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞–∂–¥–æ–º—É —É—á–∞—Å—Ç–Ω–∏–∫—É –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç–æ–º, –∫–æ–º—É –æ–Ω –¥–∞—Ä–∏—Ç –ø–æ–¥–∞—Ä–æ–∫.  
  ‚úâÔ∏è _–û—Ç–≤–µ—Ç:_ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –æ–±—â–µ–º —á–∞—Ç–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

- **`/reset`**  
  üîπ –°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É.  
  _–û–ø–∏—Å–∞–Ω–∏–µ:_ –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–π –∏–≥—Ä—ã, –ø–æ–∑–≤–æ–ª—è—è –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é.  
  ‚úâÔ∏è _–û—Ç–≤–µ—Ç:_ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º —Å–±—Ä–æ—Å–µ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é.

### –î–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- **`/join`**  
  üîπ –ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —É—á–∞—Å—Ç–∏–µ.  
  _–û–ø–∏—Å–∞–Ω–∏–µ:_ –ü–æ–∑–≤–æ–ª—è–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫—É –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ —Ç–µ–∫—É—â–µ–π –∏–≥—Ä–µ.  
  ‚úâÔ∏è _–û—Ç–≤–µ—Ç:_ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—É–º–º–µ –ø–æ–¥–∞—Ä–∫–∞.
---

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:  
- **FluentValidation** (–≤–µ—Ä—Å–∏—è 11.11.0) ‚Äî –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π.  
- **Microsoft.EntityFrameworkCore** (–≤–µ—Ä—Å–∏—è 8.0.0) ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.  
- **Microsoft.EntityFrameworkCore.Design** (–≤–µ—Ä—Å–∏—è 8.0.0) ‚Äî –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π.  
- **Npgsql** (–≤–µ—Ä—Å–∏—è 8.0.0) ‚Äî –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è PostgreSQL.  
- **Npgsql.EntityFrameworkCore.PostgreSQL** (–≤–µ—Ä—Å–∏—è 8.0.0) ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è EF Core —Å PostgreSQL.  
- **Telegram.Bot** (–≤–µ—Ä—Å–∏—è 22.2.0) ‚Äî –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Telegram API.  

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `dotnet add package`. –ü—Ä–∏–º–µ—Ä—ã:  

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ **FluentValidation**:  
   ```bash
   dotnet add package FluentValidation --version 11.11.0
   ```  

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ **Microsoft.EntityFrameworkCore**:  
   ```bash
   dotnet add package Microsoft.EntityFrameworkCore --version 8.0.0
   ```  

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ **Microsoft.EntityFrameworkCore.Design**:  
   ```bash
   dotnet add package Microsoft.EntityFrameworkCore.Design --version 8.0.0
   ```  

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ **Npgsql**:  
   ```bash
   dotnet add package Npgsql --version 8.0.0
   ```  

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ **Npgsql.EntityFrameworkCore.PostgreSQL**:  
   ```bash
   dotnet add package Npgsql.EntityFrameworkCore.PostgreSQL --version 8.0.0
   ```  

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ **Telegram.Bot**:  
   ```bash
   dotnet add package Telegram.Bot --version 22.2.0
   ```  

---

## –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `appsettings.json` —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–∫–µ–Ω –±–æ—Ç–∞, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö).  

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:  
   ```bash
   dotnet ef database update
   ```  

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:  
   ```bash
   dotnet run
   ```  

---

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤ –∫–ª–∞—Å—Å–µ **AuthorizationService**. –ü—Ä–∏–º–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:

```csharp
/// <summary>
/// –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤.
/// </summary>
/// <param name="admins">–ö–æ–ª–ª–µ–∫—Ü–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏.</param>
public AuthorizationService()
{
    _admins = new List<long>
    {
        904281253
    };
}
```

---

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∏–≥—Ä—ã
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–≥—Ä—ã –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–º–∞–Ω–¥—ã `/start`. –ü—Ä–∏–º–µ—Ä:

```csharp
if (message.Text.StartsWith("/start"))
{
    await adminController.StartGame(chatId, userId, "–†–£–ë", 200);
}
```

---

## –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É.

